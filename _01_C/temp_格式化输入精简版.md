#### 格式化输入

*scanf-like* 转换说明符：

```c
"%[]"
"%[*][width][length]specifier"
/* format 格式说明符
    *          赋值抑制符，匹配但不存储
    width      最大字符宽度
    length     长度修饰符
    specifier  转换说明符 
*/
scanf("%d %s", &n)
```

格式化输入函数的`format`参数由三部分组成：
- **普通字符**：必须与输入流中的字符完全匹配
- **空白符**：匹配输入中的任意连续空白符
- **转换规范**：以`%`开头，格式为：
  ```
  
  ```

## 2. 转换规范组成

| 组件 | 说明 |
|------|------|
| `*` | 赋值抑制符（匹配但不存储） |
| `width` | 最大字符宽度（防止缓冲区溢出） |
| `length` | 长度修饰符（指定接收变量类型） |
| `specifier` | 转换说明符（指定转换类型） |

## 3. 常用长度修饰符

| 修饰符 | 适用类型 | 说明 |
|--------|----------|------|
| `hh` | char | 指向signed char或unsigned char的指针 |
| `h` | short | 指向signed short或unsigned short的指针 |
| `l` | long | 指向long或unsigned long的指针 |
| `ll` | long long | 指向long long或unsigned long long的指针 |
| `L` | long double | 指向long double的指针 |
| `z` | size_t | 指向size_t的指针 |

## 4. 常用转换说明符

### 整数转换
| 说明符 | 类型 | 匹配内容 |
|--------|------|----------|
| `d` | int | 有符号十进制整数 |
| `i` | int | 有符号整数（支持八进制0开头，十六进制0x开头） |
| `u` | unsigned int | 无符号十进制整数 |
| `o` | unsigned int | 无符号八进制整数 |
| `x`, `X` | unsigned int | 无符号十六进制整数 |
| `b` | unsigned int | 无符号二进制整数 |

### 浮点数转换
| 说明符 | 类型 | 匹配内容 |
|--------|------|----------|
| `f`, `F` | float | 浮点数 |
| `e`, `E` | float | 科学计数法表示的浮点数 |
| `g`, `G` | float | 自动选择f或e格式 |
| `a`, `A` | float | 十六进制表示的浮点数 |

### 字符和字符串
| 说明符 | 类型 | 匹配内容 |
|--------|------|----------|
| `c` | char | 指定宽度的字符序列 |
| `s` | char* | 非空白字符序列（自动添加结束符） |
| `[` | char* | 扫描集（匹配指定字符集合） |

### 其他
| 说明符 | 类型 | 匹配内容 |
|--------|------|----------|
| `p` | void** | 指针地址 |
| `n` | int* | 已读取的字符数（不消耗输入） |
| `%` | 无 | 匹配单个%字符 |

## 5. 扫描集详解

扫描集用于匹配指定的字符集合：
- `%[abc]`：匹配包含a、b、c的字符序列
- `%[^abc]`：匹配不包含a、b、c的字符序列
- `%[0-9]`：匹配数字字符
- `%[a-zA-Z]`：匹配字母字符

## 6. 输入匹配规则

1. 空白符：跳过输入中的所有连续空白符
2. 普通字符：必须与输入完全匹配
3. 转换说明符：根据类型匹配相应的输入
4. 宽度限制：限制匹配的最大字符数
5. 赋值抑制：使用`*`匹配但不存储结果

## 7. 安全注意事项

- 始终指定宽度限制，防止缓冲区溢出
- 使用`scanf_s`（Windows）或确保目标缓冲区足够大
- 检查返回值，确认成功匹配的项目数

## 8. 示例代码

```c
#include <stdio.h>

int main() {
    int i, j;
    float x, y;
    char str1[10], str2[4];
    
    char input[] = "25 54.32E-1 Thompson 56789 0123";
    
    // 解析输入
    int ret = sscanf(input, "%d%f%9s%2d%*d %3[0-9]", 
                    &i, &x, str1, &j, str2);
    
    // 输出结果
    printf("成功匹配 %d 项:\n", ret);
    printf("i = %d\n", i);
    printf("x = %f\n", x);
    printf("str1 = %s\n", str1);
    printf("j = %d\n", j);
    printf("str2 = %s\n", str2);
    
    return 0;
}
```

## 9. 输出结果

```
成功匹配 5 项:
i = 25
x = 5.432000
str1 = Thompson
j = 56
str2 = 012
```

## 10. 常见错误与解决方案

| 错误 | 原因 | 解决方案 |
|------|------|----------|
| 缓冲区溢出 | 未指定宽度 | 使用`%10s`等指定最大宽度 |
| 类型不匹配 | 变量类型与说明符不匹配 | 确保变量类型与说明符一致 |
| 输入失败 | 输入格式与预期不符 | 检查输入格式，使用返回值判断 |
| 跳过输入 | 空白符处理 | 注意格式字符串中的空白符 |